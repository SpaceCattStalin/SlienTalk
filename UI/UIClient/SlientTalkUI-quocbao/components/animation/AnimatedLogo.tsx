import React, { useEffect } from "react";
import { View } from "react-native";
import Svg, { Path } from "react-native-svg";
import Animated, {
    useSharedValue,
    useAnimatedProps,
    withTiming,
    ReduceMotion,
    Easing,
    useAnimatedStyle,
    runOnJS,
} from "react-native-reanimated";
import LottieView from 'lottie-react-native';

import { colors } from '@/global/theme';

const AnimatedPath1 = Animated.createAnimatedComponent(Path);

type Props = {
    onCompleted: () => void;
};

export default function AnimatedLogoExample() {
    const length = 600;
    const strokeProgress = useSharedValue(length);
    let logoPosition = useSharedValue(-40);

    const strokeColor = colors.gray100;

    const animatedLogoStyle = useAnimatedStyle(() => ({
        transform: [{ translateY: logoPosition.value }]
    }));

    useEffect(() => {
        logoPosition.value = withTiming(0, {
            duration: 2000,
            easing: Easing.inOut(Easing.quad),
            reduceMotion: ReduceMotion.System,
        });
        // strokeProgress.value = withTiming(0, { duration: 2000 }, (isFinished) => {
        //     if (isFinished) {
        //         runOnJS(onCompleted)();
        //     }
        // });
        strokeProgress.value = withTiming(0, { duration: 2000 });
    }, [logoPosition]);

    const animatedProps = useAnimatedProps(() => {
        return {
            strokeDasharray: [length, length],
            strokeDashoffset: strokeProgress.value,
        };
    });


    return (

        <Animated.View style={[
            animatedLogoStyle,
        ]}>
            <Svg
                width={100}
                height={100}
                viewBox="-10 -10 180 180"
                preserveAspectRatio="xMidYMid meet"
            >
                <AnimatedPath1
                    d="M43.8463 160C43.4478 160 43.0448 159.989 42.6342 159.968C21.008 158.807 3.2328 128.543 0.806035 102.106C-0.155576 91.6298 0.37341 63.869 14.1785 61.2493C21.7107 59.8182 29.5525 66.4467 38.1723 81.501C39.5409 83.8918 38.635 86.8965 36.1491 88.2121C33.6601 89.5298 30.5372 88.6565 29.17 86.2673C21.8742 73.5239 17.0589 70.9477 16.1454 70.9477C16.143 70.9477 16.1394 70.9477 16.1369 70.9477C13.5054 71.9555 9.56538 85.1376 11.0425 101.238C12.0624 112.338 16.3311 124.663 22.4645 134.206C28.7168 143.936 36.2766 149.729 43.206 150.102C48.0844 150.359 51.5828 147.554 56.899 142.95C62.4697 138.126 69.4377 132.1 80.0084 132.306C91.0424 132.498 101.732 139.148 111.778 152.076C113.477 154.263 113.012 157.359 110.739 158.992C108.465 160.626 105.245 160.177 103.547 157.992C95.4994 147.638 87.5181 142.32 79.8238 142.187C73.2442 142.099 68.8696 145.883 63.7761 150.293C58.5086 154.855 52.5686 160 43.8463 160Z"
                    stroke={strokeColor}
                    fill="none"
                    strokeWidth="10"
                    opacity={0.5}
                    animatedProps={animatedProps}
                />

                <AnimatedPath1
                    d="M17.6602 45.1523C29.0962 2.61661 35.1589 -0.454207 39.9004 0.0439453C45.091 0.565478 47.2145 7.59275 48.4844 13.6572C49.7323 19.6204 50.7161 28.0012 51.4307 38.6816C56.06 35.1444 62.3747 33.8455 68.3633 35.7666C71.6015 36.8044 74.4034 38.6655 76.54 41.1523C81.1821 35.8178 88.8847 33.4482 96.1104 35.7666C99.2551 36.7746 101.987 38.5602 104.1 40.9404C115.788 20.0083 120.743 16.5585 125.054 17.9893C129.438 19.4333 131.207 24.7486 127.283 47.6475C126.953 49.5728 125.135 50.8593 123.223 50.5332C121.308 50.2007 120.026 48.3697 120.356 46.4443C122.466 34.1292 122.591 28.4954 122.361 25.9658C120.319 28.0437 116.069 33.5922 108.042 48.3848C108.845 51.5813 108.71 54.9285 107.612 58.0938C107.106 59.5531 105.746 60.4678 104.293 60.4678C103.909 60.4678 103.518 60.403 103.136 60.2686C101.302 59.6242 100.335 57.6058 100.975 55.7607C101.855 53.2247 101.668 50.4776 100.451 48.0244C99.1432 45.3887 96.8444 43.4304 93.9775 42.5117C88.5658 40.7734 82.5376 43.3789 80.2578 48.2373C81.1023 51.4783 80.9799 54.8798 79.8662 58.0938C79.3593 59.5528 78.0005 60.4676 76.5479 60.4678C76.1639 60.4678 75.7717 60.4031 75.3887 60.2686C73.556 59.6242 72.5883 57.6057 73.2285 55.7607C74.1078 53.2247 73.9221 50.4776 72.7051 48.0244C71.3976 45.3888 69.0992 43.4304 66.2324 42.5117C60.4739 40.6614 54.0138 43.7309 52.1191 49.2002C52.091 49.2812 52.0587 49.3599 52.0254 49.4375C52.1315 51.8082 52.2285 54.2655 52.3135 56.8086C52.3787 58.761 50.8581 60.3997 48.9189 60.4658C48.8783 60.4671 48.8385 60.4668 48.7979 60.4668C46.9122 60.4668 45.351 58.9594 45.2871 57.0459C44.0007 18.5213 40.5488 9.5243 39.1494 7.44629C37.477 9.0407 32.761 16.0713 24.4463 47.001C23.9382 48.8888 22.0034 49.9965 20.1348 49.4932C18.262 48.9833 17.1536 47.0386 17.6602 45.1523Z"
                    stroke={strokeColor}
                    fill="none"
                    strokeWidth="10"
                    opacity={0.5}
                    animatedProps={animatedProps}
                />

                <AnimatedPath1
                    d="M128.229 61.9697C130.616 60.4895 133.794 61.1504 135.333 63.4434C141.269 72.294 144.744 82.3236 145.388 92.4512C145.389 92.4698 145.391 92.4883 145.393 92.5068L145.454 93.6953C146.472 118.542 130.407 135.967 125.392 140.771C124.389 141.733 123.076 142.214 121.765 142.214C120.448 142.214 119.129 141.728 118.124 140.759C116.121 138.826 116.128 135.698 118.139 133.772C121.945 130.126 133.249 117.928 134.993 100.495C125.138 104.32 112.467 107.576 97.8965 107.576C93.4372 107.576 88.8013 107.271 84.0117 106.584C73.853 105.127 63.9845 102.066 54.6807 97.4844C52.1548 96.2405 51.1559 93.2639 52.4492 90.835C53.7426 88.4054 56.8397 87.4451 59.3633 88.6885C67.6727 92.7788 76.475 95.5116 85.5264 96.8105C105.78 99.7154 123.055 94.9416 134.809 89.8232C133.815 82.4875 131.042 75.2799 126.696 68.7998C125.158 66.5067 125.844 63.4488 128.229 61.9697Z"
                    stroke={strokeColor}
                    fill="none"
                    strokeWidth="10"
                    opacity={0.5}
                    animatedProps={animatedProps}
                />

            </Svg>
      

        </Animated.View>
    );
}
